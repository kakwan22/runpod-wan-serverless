# EXTENDS BASE IMAGE WITH MODELS 
FROM kakwan22/wanrunpod:latest

# Set working directory to ComfyUI
WORKDIR /ComfyUI

# HF token for model downloads
ARG HF_TOKEN
ENV HF_TOKEN=$HF_TOKEN

# Force cache bust for model downloads - v8
RUN echo "Model download cache bust v8"

# Ensure directories exist and clean up any existing models
RUN mkdir -p models/checkpoints models/clip_vision && \
    rm -rf models/checkpoints/* models/clip_vision/* || true

# Simple direct download - RunPod recommended approach
RUN huggingface-cli download Phr00t/WAN2.2-14B-Rapid-AllInOne v10/wan2.2-i2v-rapid-aio-v10-nsfw.safetensors --local-dir /ComfyUI/models/checkpoints --local-dir-use-symlinks False
RUN huggingface-cli download lllyasviel/misc clip_vision_vit_h.safetensors --local-dir /ComfyUI/models/clip_vision --local-dir-use-symlinks False